
<!-- saved from url=(0064)http://cykod.github.com/FrontEndPresentation/kinvey-example.html -->
<html><body><div class="webkit-line-gutter-backdrop"></div><table><tbody><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-doctype">&lt;!DOCTYPE HTML&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;html <span class="webkit-html-attribute-name">lang</span>="<span class="webkit-html-attribute-value">en</span>"&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;head&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;meta <span class="webkit-html-attribute-name">charset</span>="<span class="webkit-html-attribute-value">UTF-8</span>"&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;title&gt;</span><span class="webkit-html-tag">&lt;/title&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      <span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">src</span>='<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://cykod.github.com/FrontEndPresentation/dist/jquery.min.js">dist/jquery.min.js</a>'&gt;</span><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      <span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">src</span>='<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://cykod.github.com/FrontEndPresentation/dist/jquery.mustache.js">dist/jquery.mustache.js</a>'&gt;</span><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      <span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">src</span>='<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://cykod.github.com/FrontEndPresentation/dist/jquery.base64.js">dist/jquery.base64.js</a>'&gt;</span><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      <span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">src</span>='<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://cykod.github.com/FrontEndPresentation/dist/underscore.js">dist/underscore.js</a>'&gt;</span><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      <span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">src</span>='<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://cykod.github.com/FrontEndPresentation/dist/backbone.js">dist/backbone.js</a>'&gt;</span><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/head&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;body&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">$(function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var kinvey_app_key = 'kid1905';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var kinvey_secret = '19424ccb92f24c35909fd1566506db63';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  // Modified sync to add authorization header for use with Kinvey</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var authenticatedKinveySync = function(method, model, options) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    options.beforeSend = function(jqXHR) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      jqXHR.setRequestHeader(</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      'Authorization', </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      'Basic ' + $.base64.encode(</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      kinvey_app_key + ':' + kinvey_secret</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      )</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    }</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    // Call the default Backbone sync implementation</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    Backbone.sync.call(this, method, model, options);  </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  }</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var Contact = window.Contact = Backbone.Model.extend({</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">   idAttribute: '_id',</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">   sync: authenticatedKinveySync</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  });</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var ContactCollection = Backbone.Collection.extend({</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    model: Contact,</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    sync: authenticatedKinveySync,</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    url: function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">        return 'https://baas.kinvey.com/appdata/' + kinvey_app_key + '/user_submissions/';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    }</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  });</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var ContactCollectionView = Backbone.View.extend({</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    tagName: "ul",</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    initialize: function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      _.bindAll(this,"render");</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      this.collection.on("add remove reset",this.render);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    },</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    render: function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      $(this.el).empty();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      this.collection.each(function(contact) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">        $(this.el).append(new ContactView({model: contact }).render().el);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      },this);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      return this;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    }</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  });</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var ContactView = Backbone.View.extend({</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    tagName: "li",</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    events: {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      "click button": "deleteme"</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    },</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    initialize: function(options) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      _.bindAll(this,"render","deleteme");</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      this.model.on("change",this.render);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    },</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    render: function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      $(this.el).empty()</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">                .append($("#contact-template").mustache(this.model.attributes));</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      return this;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    },</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    deleteme: function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      this.model.destroy();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    }</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  });</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  var AddContactView = Backbone.View.extend({</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    events: {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      "click button": "addcontact"</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    },</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    initialize: function(options) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    },</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    render: function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      $(this.el).empty()</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">                .append($("#contact-create").mustache());</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      return this;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    },</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    addcontact: function() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      var contact = new Contact({</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">        first_name: this.$("#first_name").val(),</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">        last_name: this.$("#last_name").val(),</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">        phone: this.$("#phone").val() });</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      contacts.add(contact);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      contact.save();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">      this.render();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">    }</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  });</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">   var contacts = window.contacts = new ContactCollection();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">   $("#container").append(new AddContactView().render().el);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">   $("#container").append(new ContactCollectionView({ collection: contacts }).render().el);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">   contacts.fetch();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">});</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/script&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>='<span class="webkit-html-attribute-value">mustache</span>' <span class="webkit-html-attribute-name">id</span>='<span class="webkit-html-attribute-value">contact-template</span>'&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">&lt;div&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  {{first_name}} {{last_name}} - {{phone}} &lt;button&gt;Delete&lt;/button&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">&lt;/div&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>='<span class="webkit-html-attribute-value">mustache</span>' <span class="webkit-html-attribute-name">id</span>='<span class="webkit-html-attribute-value">contact-create</span>'&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">&lt;div&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  &lt;input placeholder='first name' id="first_name" /&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  &lt;input placeholder='last name' id="last_name" /&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  &lt;input placeholder='phone' id="last_name" /&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">  &lt;button&gt;Add&lt;/button&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">&lt;/div&gt;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;div <span class="webkit-html-attribute-name">id</span>='<span class="webkit-html-attribute-value">container</span>'&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/div&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/body&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/html&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"></td></tr></tbody></table></body></html>